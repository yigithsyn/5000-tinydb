<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>3001-dirtree</title>

  <link rel="stylesheet" href="bower_components/webix/codebase/webix.css" type="text/css" charset="utf-8">
  <script src="bower_components/webix/codebase/webix.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>
  <script>
    function formatBytes(a, b) { if (0 == a) return "0 Bytes"; var c = 1024, d = b || 2, e = ["Bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"], f = Math.floor(Math.log(a) / Math.log(c)); return parseFloat((a / Math.pow(c, f)).toFixed(d)) + " " + e[f] }
    webix.ready(function () {
      var myjson = webix.DataDriver.myjson = webix.copy(webix.DataDriver.json);
      myjson.child = function (obj) {
        return obj.children;
      };
      webix.ui({
        rows: [
          { view: "toolbar", elements: [{ view: "label", width: 450, label: "Usage: GET /dirtree?path=&lt path &gt" }] },
          {
            view: "form", elements: [
              {
                id: "pathInput", view: "text", label: "Path", name: "path", placeholder: "Enter full path to expand here..", on: {
                  "onChange": function (newv, oldv) {
                    $$("directoryTree").clearAll()
                    $$("directoryTree").load("/dirtree?path=" + newv);
                    setTimeout(function () { $$("directoryTree").openAll() }, 2000)
                  }
                }
              },
            ]
          },
          {
            id: "directoryTree",
            view: "treetable",
            columns: [
              { id: "name", header: "Path", fillspace: 1, template: "{common.treetable()} #name#" },
              { id: "size", header: "Size", width: 125, template: function (obj) { return formatBytes(obj.size); } },
            ],
            data: [{ name: "Path", open: true, children: [{ name: "Sub-Path" }] }],
            datatype: "myjson",
            select: true,
          }
        ]
      });
    })
  </script>
</body>

</html>